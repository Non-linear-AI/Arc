# Arc Tool Definitions
# This file defines all tools available to the Arc agent.
# Tools are loaded dynamically and converted to ArcTool instances.

tools:
  - name: view_file
    description: View contents of a file or list directory contents
    parameters:
      type: object
      properties:
        path:
          type: string
          description: Path to file or directory to view
        start_line:
          type: integer
          description: Starting line number for partial file view (optional)
        end_line:
          type: integer
          description: Ending line number for partial file view (optional)
      required:
        - path

  - name: create_file
    description: Create a new file with specified content
    parameters:
      type: object
      properties:
        path:
          type: string
          description: Path where the file should be created
        content:
          type: string
          description: Content to write to the file
      required:
        - path
        - content

  - name: edit_file
    description: Edit an existing file by replacing text using EXACT string matching. The old_str must match exactly including whitespace and line breaks. If the string is not found or appears multiple times, the tool will return a clear error. Use view_file first to see the exact text to match.
    parameters:
      type: object
      properties:
        path:
          type: string
          description: Path to the file to edit
        old_str:
          type: string
          description: Text to replace (must match exactly including all whitespace and line breaks)
        new_str:
          type: string
          description: Text to replace with
        replace_all:
          type: boolean
          description: Replace all occurrences (default false, only replaces first occurrence)
      required:
        - path
        - old_str
        - new_str

  - name: bash
    description: Execute a bash command
    parameters:
      type: object
      properties:
        command:
          type: string
          description: The bash command to execute
      required:
        - command

  - name: search
    description: Unified search tool for finding text content or files
    parameters:
      type: object
      properties:
        query:
          type: string
          description: Text to search for or file name/path pattern
        search_type:
          type: string
          enum:
            - text
            - files
            - both
          description: "Type of search: 'text' for content search, 'files' for file names, 'both' for both (default: 'both')"
        include_pattern:
          type: string
          description: "Glob pattern for files to include (e.g. '*.ts', '*.js')"
        exclude_pattern:
          type: string
          description: "Glob pattern for files to exclude (e.g. '*.log', 'node_modules')"
        case_sensitive:
          type: boolean
          description: Whether search should be case sensitive (default false)
        whole_word:
          type: boolean
          description: Whether to match whole words only (default false)
        regex:
          type: boolean
          description: Whether query is a regex pattern (default false)
        max_results:
          type: integer
          description: Maximum number of results to return (default 50)
        file_types:
          type: array
          items:
            type: string
          description: "File types to search (e.g. ['js', 'ts', 'py'])"
        include_hidden:
          type: boolean
          description: Whether to include hidden files (default false)
      required:
        - query

  - name: create_todo_list
    description: Create a new todo list for planning and tracking tasks
    parameters:
      type: object
      properties:
        todos:
          type: array
          description: Array of todo items to create
          items:
            type: object
            properties:
              id:
                type: string
                description: Unique identifier for the todo item
              content:
                type: string
                description: Description of the todo item
              status:
                type: string
                enum:
                  - pending
                  - completed
                description: Current status of the todo item (default pending)
            required:
              - id
              - content
              - status
      required:
        - todos

  - name: update_todo_list
    description: Update existing todos in the todo list by ID
    parameters:
      type: object
      properties:
        updates:
          type: array
          description: Array of todo updates
          items:
            type: object
            properties:
              id:
                type: string
                description: ID of the todo item to update
              status:
                type: string
                enum:
                  - pending
                  - completed
                description: New status for the todo item
              content:
                type: string
                description: New content for the todo item
              priority:
                type: string
                enum:
                  - high
                  - medium
                  - low
                description: New priority for the todo item
            required:
              - id
      required:
        - updates

  - name: database_query
    description: |
      Execute READ-ONLY SQL queries (SELECT, SHOW, DESCRIBE) for data exploration and analysis.
      Returns results immediately without confirmation. For data transformations that write/modify
      data (INSERT, UPDATE, DELETE, CREATE TABLE, etc.), use data_processor_generator instead.
    parameters:
      type: object
      properties:
        query:
          type: string
          description: SQL query to execute
        target_db:
          type: string
          enum:
            - system
            - user
          description: "Target database: 'system' for read-only queries (default), 'user' for full SQL access"
        validate_schema:
          type: boolean
          description: Whether to validate query against database schema (default true)
      required:
        - query

  - name: schema_discovery
    description: Discover and explore database schema information
    parameters:
      type: object
      properties:
        action:
          type: string
          enum:
            - list_tables
            - describe_table
            - show_schema
          description: "Schema discovery action: 'list_tables' shows all tables, 'describe_table' shows detailed table structure, 'show_schema' shows complete database overview"
        target_db:
          type: string
          enum:
            - system
            - user
          description: "Target database: 'system' for Arc metadata, 'user' for training data (default: system)"
        table_name:
          type: string
          description: Specific table name (required for 'describe_table' action)
      required:
        - action

  - name: ml_plan
    description: |
      Create comprehensive ML workflow plan for a modeling task. This tool analyzes data,
      user requirements, and creates a detailed plan covering feature engineering, model
      architecture, training strategy, and evaluation metrics. ALWAYS use this FIRST
      before building ML models.
    parameters:
      type: object
      properties:
        user_context:
          type: string
          description: Description of the ML problem, goals, and requirements
        source_tables:
          type: string
          description: Comma-separated list of database tables to analyze (e.g., 'users,transactions' or 'pidd')
        feedback:
          type: string
          description: Optional feedback to revise an existing plan
      required:
        - user_context
        - source_tables

  - name: ml_model
    description: Generate Arc-Graph model YAML using the model generator agent
    parameters:
      type: object
      properties:
        name:
          type: string
          description: Model name to include in the specification
        context:
          type: string
          description: Description of the intended model behavior
        data_table:
          type: string
          description: Database table to profile for generation
        output_path:
          type: string
          description: Optional file path to save the generated model YAML
      required:
        - name
        - context
        - data_table

  - name: ml_train
    description: |
      Generate Arc-Graph trainer specification and launch training. This unified tool:
      1) Generates trainer spec via LLM based on model and training goals,
      2) Presents interactive confirmation workflow,
      3) Auto-registers trainer to database after approval,
      4) Launches training after user confirmation.
      All training configuration (epochs, batch_size, learning_rate, etc.) must be specified
      in the generated trainer YAML - no runtime overrides are supported.
    parameters:
      type: object
      properties:
        name:
          type: string
          description: Trainer name for the specification
        context:
          type: string
          description: |
            Training goals, constraints, and requirements. Include all training configuration
            details (epochs, batch size, learning rate, validation strategy, etc.) as these
            will be encoded in the trainer YAML.
        model_id:
          type: string
          description: Model ID with version (e.g., 'my_model-v1')
        train_table:
          type: string
          description: Training data table name
      required:
        - name
        - context
        - model_id
        - train_table

  - name: ml_evaluate
    description: |
      Generate Arc-Graph evaluator specification and run evaluation on test data.
      This unified tool:
      1) Generates evaluator spec via LLM based on evaluation goals,
      2) Presents interactive confirmation workflow,
      3) Auto-registers evaluator to database after approval,
      4) Runs evaluation and logs metrics to TensorBoard after user confirmation.
      Supports classification metrics (accuracy, precision, recall, F1, confusion matrix,
      PR curves, ROC curves) and regression metrics (MSE, MAE, RÂ², scatter plots).
    parameters:
      type: object
      properties:
        name:
          type: string
          description: Evaluator name for the specification
        context:
          type: string
          description: |
            Evaluation goals, constraints, and requirements. Specify which metrics
            to compute and any evaluation-specific notes.
        trainer_id:
          type: string
          description: Trainer ID (without version, e.g., 'my_trainer')
        test_table:
          type: string
          description: Test dataset table name
        target_column:
          type: string
          description: Target column name for evaluation
        metrics:
          type: array
          items:
            type: string
          description: Optional list of specific metrics to compute (e.g., ['accuracy', 'precision', 'recall', 'f1_score'])
        version:
          type: integer
          description: Optional specific trainer version to evaluate (default latest version)
      required:
        - name
        - context
        - trainer_id
        - test_table
        - target_column

  - name: data_processor_generator
    description: |
      Generate and execute SQL data processing pipelines for WRITE OPERATIONS.
      Use when users describe data transformations, feature engineering, or operations
      that create/modify tables (INSERT, UPDATE, DELETE, CREATE TABLE, etc.).
      Workflow:
      1) Generate YAML from description,
      2) Show user for review/editing,
      3) Execute pipeline after confirmation,
      4) Create output tables.
      For read-only SELECT queries, use database_query for immediate results.
    parameters:
      type: object
      properties:
        action:
          type: string
          enum:
            - generate
            - validate
          description: "Action to perform: 'generate' creates YAML from natural language (default), 'validate' checks existing YAML configuration"
        name:
          type: string
          description: Name for the data processor (will be registered in database)
        context:
          type: string
          description: Natural language description of data processing requirements (required for 'generate' action)
        target_tables:
          type: array
          items:
            type: string
          description: List of database tables to analyze for generation (optional)
        output_path:
          type: string
          description: Path to save generated YAML or validate existing YAML file
        target_db:
          type: string
          enum:
            - system
            - user
          description: "Target database for schema discovery: 'system' for Arc metadata, 'user' for training data (default: user)"
        yaml_content:
          type: string
          description: Raw YAML content for validation (alternative to output_path)
      required:
        - name
        - context
